import{n as c}from"./chunk-JK5TQ35Y.js";var e=class e{sanitizeText(t){return t?t.trim().replace(/\0/g,"").slice(0,1e4):""}sanitizeHtml(t){return t?t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<[^>]+>/g,"").trim().slice(0,1e4):""}sanitizeEmail(t){if(!t)return"";let r=t.trim().toLowerCase();if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r))throw new Error("Invalid email format");return r}sanitizeFileName(t){return t?t.trim().replace(/[\/\\]/g,"").replace(/\0/g,"").replace(/[<>:"|?*]/g,"").slice(0,255):""}sanitizeNumber(t){let r=parseFloat(t);if(isNaN(r)||!isFinite(r))throw new Error("Invalid number");return r}sanitizeInteger(t){let r=parseInt(t,10);if(isNaN(r)||!isFinite(r))throw new Error("Invalid integer");return r}sanitizeUrl(t){if(!t)return"";let r=t.trim();if(!r.startsWith("http://")&&!r.startsWith("https://"))throw new Error("URL must start with http:// or https://");if(r.toLowerCase().startsWith("javascript:")||r.toLowerCase().startsWith("data:"))throw new Error("Invalid URL protocol");return r.slice(0,2048)}sanitizeName(t){return t?t.trim().replace(/[\x00-\x1F\x7F]/g,"").replace(/[^a-zA-Z0-9\s\-\_\.\,\(\)]/g,"").slice(0,255):""}sanitizeNotes(t){return t?t.trim().replace(/\0/g,"").replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").slice(0,5e3):""}sanitizeSku(t){return t?t.trim().toUpperCase().replace(/[^A-Z0-9\-]/g,"").slice(0,100):""}sanitizeSpecifications(t){let r={};for(let[i,n]of Object.entries(t)){let s=this.sanitizeName(i).slice(0,100);s&&(typeof n=="number"?r[s]=this.sanitizeNumber(n):r[s]=this.sanitizeText(String(n)).slice(0,500))}let a=Object.keys(r).slice(0,50),o={};for(let i of a)o[i]=r[i];return o}sanitizeDate(t){if(!t)return"";let r=new Date(t);if(isNaN(r.getTime()))throw new Error("Invalid date format");return r.toISOString().split("T")[0]}sanitizeDeviceStatus(t){let r=t?.toLowerCase().trim();if(r==="operational"||r==="maintenance"||r==="offline")return r;throw new Error("Invalid device status")}sanitizeMaintenanceType(t){let r=t?.toLowerCase().trim();if(r==="scheduled"||r==="emergency")return r;throw new Error("Invalid maintenance type")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});var l=e;export{l as a};
